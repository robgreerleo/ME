-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\roble\Desktop\Working\STATA\HW 11/leonard_exc11.log
  log type:  text
 opened on:  20 Jan 2018, 15:55:38

. 
. ********************************************************
. * Q.1 Data - Generate Pop Growth Rates
. 
. use "$datadir\hornung-rail-cross-section.dta", clear

. 
. // compute population growth rates
. * for loops, you can't just indicate use the next or previous variable
. * but you can use a local/global macro looping over all the years, always
. * overiding the initial value with a new one
. local priorperiod = 1816

. foreach k of numlist 1821 1831 1837(3)1867 1871 1880 1885 {
  2. gen gr_`priorperiod'_`k' = ( ln(pop`k'civil)-ln(pop`priorperiod'civil) ) /  ///
> (`k'-`priorperiod')
  3. local priorperiod = `k'
  4. }  
(47 missing values generated)
(38 missing values generated)
(14 missing values generated)
(11 missing values generated)
(10 missing values generated)
(4 missing values generated)
(2 missing values generated)
(4 missing values generated)
(5 missing values generated)
(5 missing values generated)
(9 missing values generated)
(13 missing values generated)
(14 missing values generated)

. 
. ********************************************************
. * Q.2 Match Summary Statistics of Table 2
. 
. tabstat gr_*, by(rail1848) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: rail1848 (Rail access 1838-48)

rail1848 |  gr_~1821  gr_~1831  gr_~1837  gr_~1840  gr_~1843  gr_~1846  gr_~1849  gr_~1852  gr_~1855  gr_~1858  gr_~1861  gr_~1864  gr_~1867  gr_~1871  gr_~1880  gr_~1885
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       0 |  .0208975   .011085  .0139247   .015863  .0138006  .0134826  .0026069  .0141234  .0044555  .0130548  .0115493  .0116412  .0038363  .0054098  .0093544  .0043781
         |   .027166  .0146294  .0152502  .0183482  .0162884  .0151846  .0175507  .0306949  .0314621  .0465244  .0197121  .0206448  .0296653  .0197161  .0113488  .0142379
         |       834       843       859       862       863       869       872       872       872       870       869       868       868       864       860       859
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |  .0193997  .0143049  .0157508  .0180977  .0182875  .0248551  .0049456  .0191475  .0132463  .0328414  .0119715  .0246519  .0167943  .0167222  .0211768  .0164673
         |  .0168335  .0099938  .0128636  .0192493  .0174707    .01777  .0379812  .0263159  .0226194    .07758  .0483313  .0258167  .0222232  .0173889  .0157106    .01287
         |        97        97       105       105       105       105       106       106       106       106       105       105       105       105       105       105
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
   Total |  .0207414  .0114173  .0141236  .0161056  .0142873  .0147086  .0028604  .0146679  .0054083  .0152038  .0115949  .0130453  .0052346  .0066356  .0106408  .0056949
         |   .026277  .0142507  .0150135   .018451  .0164705  .0158712  .0207406  .0302791  .0307397    .05114  .0244199  .0216285   .029223  .0197844  .0124484  .0145843
         |       931       940       964       967       968       974       978       978       978       976       974       973       973       969       965       964
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. * need to partition the sample into 3 groups, not 2. create a new indicator
. gen indi_sum = 0 if node1848==1
(947 missing values generated)

. replace indi_sum = 1 if rail1848==1 & node1848==0
(76 real changes made)

. replace indi_sum = 2 if rail1848==0 & node1848==0
(871 real changes made)

. tabstat gr_*, by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |  gr_~1821  gr_~1831  gr_~1837  gr_~1840  gr_~1843  gr_~1846  gr_~1849  gr_~1852  gr_~1855  gr_~1858  gr_~1861  gr_~1864  gr_~1867  gr_~1871  gr_~1880  gr_~1885
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       0 |  .0171082  .0152428  .0171086  .0194221  .0184238  .0263246  .0127369    .01892  .0134896  .0334624  .0198605  .0305232  .0252676   .022938  .0229679  .0201525
         |  .0136382  .0100877  .0122785  .0187102  .0107414  .0203421  .0169047  .0417907  .0201407  .0498819  .0135016  .0299355  .0269747  .0158475  .0125569  .0083582
         |        31        30        30        30        30        30        31        31        31        31        31        31        31        31        31        31
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |  .0204072  .0138366  .0153057  .0176558  .0184802  .0245277  .0024085  .0193277   .013214  .0326407   .009003  .0229826  .0140479  .0144462  .0203875  .0149239
         |  .0180088  .0099323  .0130713  .0194435  .0195772  .0167872  .0436499  .0164768  .0235447  .0862024  .0563959  .0244902  .0201199  .0175568  .0167682   .014014
         |        67        68        76        76        76        76        76        76        76        76        75        75        75        75        75        75
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       2 |  .0209035  .0110856  .0139145  .0158532  .0137736  .0134473  .0025483    .01411  .0044395  .0130274  .0115236  .0115607   .003756  .0053712   .009345  .0043658
         |  .0271818  .0146381  .0152562  .0183566  .0162786  .0151578  .0174752    .03071  .0314766  .0465441  .0197089  .0205198  .0295878  .0196948   .011352  .0142416
         |       833       842       858       861       862       868       871       871       871       869       868       867       867       863       859       858
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
   Total |  .0207414  .0114173  .0141236  .0161056  .0142873  .0147086  .0028604  .0146679  .0054083  .0152038  .0115949  .0130453  .0052346  .0066356  .0106408  .0056949
         |   .026277  .0142507  .0150135   .018451  .0164705  .0158712  .0207406  .0302791  .0307397    .05114  .0244199  .0216285   .029223  .0197844  .0124484  .0145843
         |       931       940       964       967       968       974       978       978       978       976       974       973       973       969       965       964
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. // why are there still differences? we are excluding some observations 
. foreach x of var gr_* {
  2. replace `x' = . if abs(`x')>=0.1
  3. }
(9 real changes made, 9 to missing)
(2 real changes made, 2 to missing)
(4 real changes made, 4 to missing)
(1 real change made, 1 to missing)
(2 real changes made, 2 to missing)
(3 real changes made, 3 to missing)
(2 real changes made, 2 to missing)
(5 real changes made, 5 to missing)
(10 real changes made, 10 to missing)
(20 real changes made, 20 to missing)
(2 real changes made, 2 to missing)
(6 real changes made, 6 to missing)
(11 real changes made, 11 to missing)
(5 real changes made, 5 to missing)
(0 real changes made)
(1 real change made, 1 to missing)

. tabstat gr_*, by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |  gr_~1821  gr_~1831  gr_~1837  gr_~1840  gr_~1843  gr_~1846  gr_~1849  gr_~1852  gr_~1855  gr_~1858  gr_~1861  gr_~1864  gr_~1867  gr_~1871  gr_~1880  gr_~1885
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       0 |  .0171082  .0152428  .0171086  .0194221  .0184238  .0236157  .0127369  .0259308  .0134896  .0199533  .0198605  .0263927   .021838   .022938  .0229679  .0201525
         |  .0136382  .0100877  .0122785  .0187102  .0107414  .0141625  .0169047  .0151803  .0201407  .0235574  .0135016   .019491  .0193783  .0158475  .0125569  .0083582
         |        31        30        30        30        30        29        31        30        31        28        31        30        30        31        31        31
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |  .0204072  .0138366  .0153057  .0176558  .0169084   .023364  .0071312  .0193277  .0119838  .0146677  .0152545  .0214441  .0140479  .0144462  .0203875  .0149239
         |  .0180088  .0099323  .0130713  .0194435  .0140771  .0134654  .0145957  .0164768  .0211011  .0149162  .0159019  .0206889  .0201199  .0175568  .0167682   .014014
         |        67        68        76        76        75        75        75        76        75        72        74        74        75        75        75        75
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       2 |  .0192709  .0114553  .0133471  .0156905  .0139335  .0133118  .0026982  .0131796  .0029627   .008521  .0119869  .0111905  .0025477  .0047673   .009345  .0041916
         |  .0206406  .0125207  .0127671  .0177348   .015596  .0146305  .0169154  .0161549  .0140708  .0170084  .0142244  .0149789  .0167046  .0155777   .011352  .0133041
         |       824       840       854       860       861       867       870       867       862       856       867       863       857       858       859       857
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
   Total |  .0192808  .0117491  .0136197   .015961   .014304  .0143959  .0033577   .014053  .0039987  .0093187  .0124868  .0124468  .0040458  .0061047  .0106408  .0055413
         |  .0202547  .0123029  .0127896  .0179037  .0153821  .0148504  .0168601   .016357  .0152227  .0172414  .0144097  .0160504  .0176281  .0162357  .0124484  .0137894
         |       922       938       960       966       966       971       976       973       968       956       972       967       962       964       965       963
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. 
. tab node1848 rail1848

   Node of |
       the |
network in |  Rail access 1838-48
      1848 |         0          1 |     Total
-----------+----------------------+----------
         0 |       871         76 |       947 
         1 |         1         30 |        31 
-----------+----------------------+----------
     Total |       872        106 |       978 


. list city railyear if node1848==1 & rail1848==0

     +-----------------------+
     |       city   railyear |
     |-----------------------|
521. | Waldenburg       1853 |
     +-----------------------+

. 
. tabstat gr_* if city!="Waldenburg", by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |  gr_~1821  gr_~1831  gr_~1837  gr_~1840  gr_~1843  gr_~1846  gr_~1849  gr_~1852  gr_~1855  gr_~1858  gr_~1861  gr_~1864  gr_~1867  gr_~1871  gr_~1880  gr_~1885
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       0 |  .0171495   .015403   .016917  .0192555  .0177824  .0228857   .011373  .0259356   .013328  .0193279  .0193928  .0244934   .020057  .0224122  .0231503  .0203259
         |  .0138693  .0102273  .0124501  .0190188  .0103305  .0138556  .0153612  .0154489  .0204646   .023768  .0134745  .0167745  .0170406   .015841  .0127297  .0084442
         |        30        29        29        29        29        28        30        29        30        27        30        29        29        30        30        30
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |  .0204072  .0138366  .0153057  .0176558  .0169084   .023364  .0071312  .0193277  .0119838  .0146677  .0152545  .0214441  .0140479  .0144462  .0203875  .0149239
         |  .0180088  .0099323  .0130713  .0194435  .0140771  .0134654  .0145957  .0164768  .0211011  .0149162  .0159019  .0206889  .0201199  .0175568  .0167682   .014014
         |        67        68        76        76        75        75        75        76        75        72        74        74        75        75        75        75
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       2 |  .0192709  .0114553  .0133471  .0156905  .0139335  .0133118  .0026982  .0131796  .0029627   .008521  .0119869  .0111905  .0025477  .0047673   .009345  .0041916
         |  .0206406  .0125207  .0127671  .0177348   .015596  .0146305  .0169154  .0161549  .0140708  .0170084  .0142244  .0149789  .0167046  .0155777   .011352  .0133041
         |       824       840       854       860       861       867       870       867       862       856       867       863       857       858       859       857
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
   Total |  .0192845  .0117503  .0136103  .0159524  .0142804  .0143654  .0033061  .0140409  .0039839  .0092899  .0124648  .0123754  .0039736  .0060708  .0106337  .0055315
         |  .0202653  .0123094   .012793   .017911  .0153727  .0148275  .0167916  .0163611  .0152236  .0172274  .0144007   .015904  .0174942    .01621  .0124529  .0137932
         |       921       937       959       965       965       970       975       972       967       955       971       966       961       963       964       962
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. * use estpost as we have a lot of observations to ttest
. estpost ttest gr_* if node1848==0, by(rail1848)

             |      e(b)   e(count)      e(se)       e(t)    e(df_t)     e(p_l)       e(p)     e(p_u)     e(N_1)    e(mu_1)     e(N_2)    e(mu_2) 
-------------+------------------------------------------------------------------------------------------------------------------------------------
gr_1816_1821 | -.0011363        891   .0025988  -.4372335        889   .3310241   .6620482   .6689759        824   .0192709         67   .0204072 
gr_1821_1831 | -.0023813        908   .0015568  -1.529597        906   .0632328   .1264656   .9367672        840   .0114553         68   .0138366 
gr_1831_1837 | -.0019586        930   .0015312  -1.279132        928   .1005852   .2011705   .8994148        854   .0133471         76   .0153057 
gr_1837_1840 | -.0019654        936   .0021394  -.9186384        934    .179261   .3585219    .820739        860   .0156905         76   .0176558 
gr_1840_1843 | -.0029749        936   .0018638  -1.596118        934   .0554004   .1108008   .9445996        861   .0139335         75   .0169084 
gr_1843_1846 | -.0100522        942   .0017503  -5.743124        940   6.27e-09   1.25e-08          1        867   .0133118         75    .023364 
gr_1846_1849 |  -.004433        945   .0020152  -2.199824        943   .0140307   .0280614   .9859693        870   .0026982         75   .0071312 
gr_1849_1852 | -.0061481        943   .0019357   -3.17614        941   .0007705   .0015411   .9992295        867   .0131796         76   .0193277 
gr_1852_1855 | -.0090211        937   .0017757  -5.080271        935   2.27e-07   4.55e-07   .9999998        862   .0029627         75   .0119838 
gr_1855_1858 | -.0061467        928   .0020685  -2.971581        926   .0015197   .0030393   .9984803        856    .008521         72   .0146677 
gr_1858_1861 | -.0032675        941   .0017393  -1.878627        939   .0303025    .060605   .9696975        867   .0119869         74   .0152545 
gr_1861_1864 | -.0102536        937   .0018776  -5.461091        935   3.03e-08   6.07e-08          1        863   .0111905         74   .0214441 
gr_1864_1867 | -.0115002        932   .0020473  -5.617327        930   1.28e-08   2.56e-08          1        857   .0025477         75   .0140479 
gr_1867_1871 | -.0096788        933   .0018958  -5.105504        931   2.00e-07   4.00e-07   .9999998        858   .0047673         75   .0144462 
gr_1871_1880 | -.0110425        934   .0014295  -7.724502        932   1.45e-14   2.89e-14          1        859    .009345         75   .0203875 
gr_1880_1885 | -.0107322        932    .001609  -6.670119        930   2.19e-11   4.38e-11          1        857   .0041916         75   .0149239 

. * note 259 cities get treatment at some point, something to consider for table2
. count if railyear>1848 & railyear<1872
  259

. // If you are bored, you could set up an alternative growth rate for the 
. // re-classified cities and re-do the analysis (partition the sample into 4
. // groups).
. 
. // HOMEWORK: Do the results change under scenario (a) or (b)? see problem set
. * exclude all observations that have area changes prior to 1870 (areachange1,2)
. * use listwise option (constrains to the same cities all the time)
. * does the same pattern hold?
. 
. * Option a - remove incorporations prior to 1872 (areachange1 = incorporations
. * prior to 1938, areachange2 = inc. after 1837
. tab areachange1 indi_sum 

Incorporat |
      ions |
    before |       indi_sum
      1838 |         1          2 |     Total
-----------+----------------------+----------
      1831 |         2          5 |         7 
      1837 |         0          2 |         2 
-----------+----------------------+----------
     Total |         2          7 |         9 


. tab areachange2 indi_sum

Incorporat |
ions after |             indi_sum
      1837 |         0          1          2 |     Total
-----------+---------------------------------+----------
      1852 |         0          0          2 |         2 
      1855 |         0          0          2 |         2 
      1858 |         0          2          9 |        11 
      1861 |         0          0          2 |         2 
      1864 |         1          0          1 |         2 
      1867 |         0          0          1 |         1 
      1871 |         1          0          1 |         2 
      1900 |        29         74        853 |       956 
-----------+---------------------------------+----------
     Total |        31         76        871 |       978 


. * most are missing values in areachange1, all others recoded 1900 for areachange2
. * if they aren't coded as incorporating in earlier years.  missing values for
. * areachange1 are treated as large numbers in tabstat
. tabstat gr_* if city!="Waldenburg" & areachange1>=1872 & areachange2>=1872, ///
>  by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |  gr_~1821  gr_~1831  gr_~1837  gr_~1840  gr_~1843  gr_~1846  gr_~1849  gr_~1852  gr_~1855  gr_~1858  gr_~1861  gr_~1864  gr_~1867  gr_~1871  gr_~1880  gr_~1885
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       0 |  .0173415  .0153688  .0162742   .017838  .0175114  .0216882  .0114262  .0262627  .0139964  .0196679  .0182563  .0236806  .0195673   .021512  .0228395  .0195783
         |  .0142448  .0105695  .0123743  .0184929   .010657  .0131791  .0159176  .0158826   .021041  .0246535  .0114496  .0166443  .0173651  .0158856  .0129954  .0082308
         |        28        27        27        27        27        26        28        27        28        25        28        27        27        28        28        28
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       1 |  .0204072  .0138366  .0157978  .0179448    .01748  .0237987  .0073036  .0197549  .0114016  .0148804  .0152787  .0218161  .0141694  .0146986  .0207579  .0147551
         |  .0180088  .0099323  .0129541  .0197052  .0139926  .0134449  .0145826  .0165586  .0210534  .0149119  .0161178  .0206189  .0204403  .0176872  .0168446  .0136146
         |        67        68        73        73        72        72        72        73        72        71        72        71        72        72        72        72
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
       2 |  .0193221  .0116337  .0132716  .0156823  .0138763  .0132531  .0025516  .0130095  .0027531  .0085592  .0118734  .0112014  .0022707  .0045602  .0091426  .0039457
         |  .0206925  .0115391  .0126497  .0177183  .0156602  .0146685  .0170234  .0159314  .0139306  .0170226  .0142022  .0150655  .0165994  .0155755  .0112628  .0132622
         |       816       830       834       838       839       845       848       846       843       842       846       843       835       837       837       835
---------+----------------------------------------------------------------------------------------------------------------------------------------------------------------
   Total |  .0193411  .0119047  .0135559  .0159205  .0142575  .0142908  .0031746  .0139083  .0037473  .0093337  .0123215  .0123604  .0036879  .0058458  .0104444  .0052462
         |   .020328  .0114214  .0126791  .0178951  .0154451  .0148459  .0169121   .016202  .0151011  .0172621  .0143357  .0159457  .0174377  .0162029  .0124092  .0137019
         |       911       925       934       938       938       943       948       946       943       938       946       941       934       937       937       935
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------

. estpost ttest gr_* if node1848==0 & areachange1>=1872 & areachange2>=1872, by(rail1848)

             |      e(b)   e(count)      e(se)       e(t)    e(df_t)     e(p_l)       e(p)     e(p_u)     e(N_1)    e(mu_1)     e(N_2)    e(mu_2) 
-------------+------------------------------------------------------------------------------------------------------------------------------------
gr_1816_1821 | -.0010851        883   .0026057  -.4164274        881   .3385994   .6771987   .6614006        816   .0193221         67   .0204072 
gr_1821_1831 | -.0022029        898   .0014413   -1.52835        896   .0633893   .1267786   .9366107        830   .0116337         68   .0138366 
gr_1831_1837 | -.0025262        907    .001547  -1.633004        905    .051408   .1028159    .948592        834   .0132716         73   .0157978 
gr_1837_1840 | -.0022625        911   .0021824  -1.036687        909   .1500787   .3001574   .8499213        838   .0156823         73   .0179448 
gr_1840_1843 | -.0036037        911   .0019079  -1.888796        909   .0296187   .0592373   .9703813        839   .0138763         72     .01748 
gr_1843_1846 | -.0105456        917   .0017896  -5.892581        915   2.67e-09   5.34e-09          1        845   .0132531         72   .0237987 
gr_1846_1849 |  -.004752        920    .002068  -2.297819        918   .0108981   .0217962   .9891019        848   .0025516         72   .0073036 
gr_1849_1852 | -.0067454        919   .0019495  -3.460028        917   .0002825    .000565   .9997175        846   .0130095         73   .0197549 
gr_1852_1855 | -.0086484        915   .0017938  -4.821343        913   8.35e-07   1.67e-06   .9999992        843   .0027531         72   .0114016 
gr_1855_1858 | -.0063213        913   .0020848  -3.032112        911   .0012486   .0024972   .9987514        842   .0085592         71   .0148804 
gr_1858_1861 | -.0034053        918   .0017629    -1.9317        916   .0268524   .0537047   .9731476        846   .0118734         72   .0152787 
gr_1861_1864 | -.0106147        914   .0019231  -5.519625        912   2.21e-08   4.43e-08          1        843   .0112014         71   .0218161 
gr_1864_1867 | -.0118987        907   .0020797  -5.721245        905   7.18e-09   1.44e-08          1        835   .0022707         72   .0141694 
gr_1867_1871 | -.0101385        909   .0019345  -5.240973        907   9.94e-08   1.99e-07   .9999999        837   .0045602         72   .0146986 
gr_1871_1880 | -.0116153        909   .0014487  -8.017956        907   1.65e-15   3.30e-15          1        837   .0091426         72   .0207579 
gr_1880_1885 | -.0108095        907   .0016324  -6.621844        905   3.04e-11   6.08e-11          1        835   .0039457         72   .0147551 

. /* No, the results do not significantly change for the t-tests if we exclude
> incorporations before 1872.  The magnitudes and statistical significance levels
> pretty much remain the same.  The 1840-43 growth rate is the only somewhat 
> notable change, with the t value increasing towards greater statistical signif.
> from 1.6 to 1.88 but this is already in line with the paper's analysis as the 
> difference in mean growth between railroad and nonrailroad cities grows here.
> */
. 
. * Option b, use listwise command to remove missing values
. estpost ttest gr_* if node1848==0, by(rail1848) listwise

             |      e(b)   e(count)      e(se)       e(t)    e(df_t)     e(p_l)       e(p)     e(p_u)     e(N_1)    e(mu_1)     e(N_2)    e(mu_2) 
-------------+------------------------------------------------------------------------------------------------------------------------------------
gr_1816_1821 | -.0025365        842   .0026435  -.9595375        840   .1687821   .3375641   .8312179        780   .0191009         62   .0216375 
gr_1821_1831 | -.0024412        842   .0014005  -1.743122        840   .0408391   .0816783   .9591609        780   .0118668         62   .0143079 
gr_1831_1837 | -.0027568        842     .00162  -1.701676        840   .0445931   .0891862   .9554069        780   .0130968         62   .0158536 
gr_1837_1840 | -.0033496        842    .002233  -1.500039        840     .06699   .1339801     .93301        780   .0157202         62   .0190698 
gr_1840_1843 | -.0027921        842   .0019862  -1.405738        840   .0800858   .1601716   .9199142        780   .0135746         62   .0163666 
gr_1843_1846 | -.0109664        842   .0018654   -5.87881        840   2.98e-09   5.96e-09          1        780   .0131695         62   .0241359 
gr_1846_1849 | -.0036047        842   .0021861  -1.648941        840   .0497669   .0995337   .9502331        780   .0027206         62   .0063253 
gr_1849_1852 | -.0068418        842   .0019964  -3.427103        840   .0003198   .0006397   .9996802        780   .0132454         62   .0200873 
gr_1852_1855 | -.0054028        842    .001826  -2.958888        840   .0015871   .0031742   .9984129        780   .0026673         62   .0080701 
gr_1855_1858 | -.0045348        842   .0021685  -2.091266        840   .0184021   .0368041   .9815979        780   .0084048         62   .0129396 
gr_1858_1861 | -.0018388        842   .0017893  -1.027694        840   .1521948   .3043896   .8478052        780   .0121258         62   .0139647 
gr_1861_1864 | -.0084187        842   .0020018  -4.205504        840   .0000144   .0000288   .9999856        780   .0113743         62    .019793 
gr_1864_1867 | -.0093698        842   .0021719    -4.3141        840   8.97e-06   .0000179    .999991        780   .0021049         62   .0114747 
gr_1867_1871 | -.0078459        842   .0020401  -3.845917        840   .0000646   .0001292   .9999354        780   .0044771         62    .012323 
gr_1871_1880 | -.0118151        842   .0015326  -7.709373        840   1.79e-14   3.57e-14          1        780   .0090617         62   .0208769 
gr_1880_1885 | -.0101223        842   .0016723  -6.052928        840   1.07e-09   2.14e-09          1        780   .0035608         62   .0136831 

. /* Listwise deletion removes the sample if any of the variables has a missing
> value (for each growth rate period comparison).  Here we remove anywhere from 
> 49 to 103 samples depending on the period, which is much more than those
> eliminated in option a above.  
> Nevertheless, the results don't change too much.  In general, the difference 
> between the means is reduced somewhat.  A notable change is in the 1858 to
> 1861 period, where the difference in mean growth rate is no longer statistically
> significant.  1846 to 1849 also moves more towards not being statistically
> significant.  Otherwise, the rest of the periods from 1843 on do show a difference
> in mean growth rates that are still statistically significant and in line with
> the paper's analysis and conclusions.
> */
. 
. ********************************************************
. * Q.3 Replicate Table 3
. 
. global control street1848_dummy ship1849_dummy ln_pop1849civil ///
> ln_pop1849military fac1849_total2_pc county_mining county_landownership ///
> pop1849_young_pc edu1849_pri_enrol dist1

. 
. tabstat slc1848 $control if city!="Waldenburg", by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |   slc1848  street~y  ship18~y  l~9civil  ln_pop~y  fac184~c  county~g  county~p  pop184~c  edu184~l     dist1
---------+--------------------------------------------------------------------------------------------------------------
       0 |         1  .9333333  .5666667  9.786747  6.379277  .0692308        .3  .0154256  .2903707   .789857         0
         |         0  .2537081  .5040069  1.144157  2.700257  .0965119  .4660916  .0130487  .0407274  .1511827         0
         |        30        30        30        30        30        30        30        30        30        30        30
---------+--------------------------------------------------------------------------------------------------------------
       1 |       .25  .5921053  .2763158  8.356822  3.158643  .0597334  .1973684  .0177192  .3338634  .9283516  .2805419
         |  .4358899  .4947088  .4501462  .7769441  2.399909  .0877804  .4006574  .0128419  .0332489  .1773599  .1979544
         |        76        76        76        76        76        76        76        76        76        76        76
---------+--------------------------------------------------------------------------------------------------------------
       2 |  .0114811  .3926521  .1905855  7.793041  2.264799  .0380288  .0952928  .0271958  .3428136  .9157237  .8031181
         |   .106594  .4886211  .3929886  .6924797  1.944096  .1198136  .2937876   .025665  .0366435  .2938753  .8867135
         |       871       871       871       871       871       871       871       871       871       871       871
---------+--------------------------------------------------------------------------------------------------------------
   Total |  .0603889  .4247697  .2088025  7.898116   2.46067  .0406753  .1095189  .0260972   .340507  .9128411  .7378066
         |   .238328  .4945612  .4066611  .8053624  2.138325  .1171525  .3124491  .0247977  .0376377  .2838496  .8606391
         |       977       977       977       977       977       977       977       977       977       977       977
------------------------------------------------------------------------------------------------------------------------

. 
. estpost ttest slc1848 $control if node1848==0, by(rail1848)

             |      e(b)   e(count)      e(se)       e(t)    e(df_t)     e(p_l)       e(p)     e(p_u)     e(N_1)    e(mu_1)     e(N_2)    e(mu_2) 
-------------+------------------------------------------------------------------------------------------------------------------------------------
     slc1848 | -.2385189        947   .0191147  -12.47827        945   1.72e-33   3.45e-33          1        871   .0114811         76        .25 
street1848~y | -.1994531        947    .058501  -3.409399        945   .0003393   .0006786   .9996607        871   .3926521         76   .5921053 
ship1849_d~y | -.0857303        947   .0475829  -1.801702        945   .0359555   .0719109   .9640445        871   .1905855         76   .2763158 
ln_pop1849~l | -.5637809        947   .0836723  -6.737966        945   1.39e-11   2.79e-11          1        871   7.793041         76   8.356822 
ln_pop1849~y | -.8938443        947   .2373137  -3.766509        945   .0000879   .0001758   .9999121        871   2.264799         76   3.158643 
fac1849_to~c | -.0217046        947   .0140647  -1.543193        945   .0615593   .1231187   .9384407        871   .0380288         76   .0597334 
county_min~g | -.1020757        947   .0363185  -2.810572        945   .0025238   .0050476   .9974762        871   .0952928         76   .1973684 
county_lan~p |  .0094766        947    .002977   3.183248        945    .999248   .0015039    .000752        871   .0271958         76   .0177192 
pop1849_yo~c |  .0089502        947    .004352   2.056571        945   .9799992   .0400016   .0200008        871   .3428136         76   .3338634 
edu1849_pr~l | -.0126279        947   .0342515  -.3686826        945   .3562234   .7124469   .6437766        871   .9157237         76   .9283516 
       dist1 |  .5225762        947   .1019805   5.124276        945   .9999998   3.62e-07   1.81e-07        871   .8031181         76   .2805419 

. 
. ********************************************************
. * Q.4 Estimate OLS 
. 
. // re-estimate panel A for columns 1 and 2 of Table 5
. // generate city growth rates
. gen gr_1816_1831 = ( ln(pop1831civil)-ln(pop1816civil) ) / (1831-1816)
(34 missing values generated)

. * ignore those that grew or declined more than 10%
. replace gr_1816_1831 = . if abs(gr_1816_1831)>=0.1
(4 real changes made, 4 to missing)

. 
. gen gr_1849_1871 = ( ln(pop1871civil)-ln(pop1849civil) ) / (1871-1849)
(8 missing values generated)

. replace gr_1849_1871 = . if abs(gr_1849_1871)>=0.1
(3 real changes made, 3 to missing)

. 
. // column (1), note std errors are clustered at county level - kreiskey
. * also ignore those that had areachanges (incorporations, sb = nonmissing)
. reg gr_1831_1837 rail1848 gr_1816_1831 $control if node1848==0 ///
>  & areachange1==., cluster(kreiskey1849)

Linear regression                               Number of obs     =        896
                                                F(12, 307)        =       2.88
                                                Prob > F          =     0.0009
                                                R-squared         =     0.0419
                                                Root MSE          =     .01261

                                 (Std. Err. adjusted for 308 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0018486     .00177     1.04   0.297    -.0016343    .0053315
        gr_1816_1831 |  -.0805263   .0694905    -1.16   0.247    -.2172643    .0562117
    street1848_dummy |   .0005914   .0009501     0.62   0.534    -.0012782     .002461
      ship1849_dummy |  -.0017786   .0009883    -1.80   0.073    -.0037234    .0001662
     ln_pop1849civil |   .0010735   .0009581     1.12   0.263    -.0008117    .0029588
  ln_pop1849military |    .000483    .000348     1.39   0.166    -.0002017    .0011678
   fac1849_total2_pc |   .0076338   .0036758     2.08   0.039     .0004009    .0148667
       county_mining |  -.0017536   .0014828    -1.18   0.238    -.0046714    .0011641
county_landownership |  -.0033389   .0189861    -0.18   0.861    -.0406982    .0340205
    pop1849_young_pc |   .0576384   .0157484     3.66   0.000       .02665    .0886268
   edu1849_pri_enrol |  -.0023177   .0020168    -1.15   0.251    -.0062863    .0016508
               dist1 |  -.0006073   .0005696    -1.07   0.287    -.0017282    .0005136
               _cons |  -.0119897   .0098381    -1.22   0.224    -.0313484     .007369
--------------------------------------------------------------------------------------

. // # obs difference of 2 stems from 10% constraint on growth, they added
. // and & abs()<0.1 in the if condition instead of resetting to missing.
. // only constrained on current period growth rate, contradicts in the control
. 
. // column(2), addrail is now a control, also change areachange to 2
. // note these were recoded, so cannot just use missing, but larger, and larger
. // includes the missing
. reg gr_1849_1871 rail1848 addrail71 gr_1831_1837 $control if node1848==0 ///
>  & areachange2>1871, cluster(kreiskey1849)

Linear regression                               Number of obs     =        902
                                                F(13, 309)        =      13.61
                                                Prob > F          =     0.0000
                                                R-squared         =     0.2125
                                                Root MSE          =      .0092

                                 (Std. Err. adjusted for 310 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0093082   .0016409     5.67   0.000     .0060795    .0125369
           addrail71 |   .0049676   .0008705     5.71   0.000     .0032547    .0066805
        gr_1831_1837 |    .099142   .0255778     3.88   0.000     .0488134    .1494707
    street1848_dummy |   .0006425   .0007456     0.86   0.389    -.0008245    .0021095
      ship1849_dummy |  -.0006759   .0008492    -0.80   0.427    -.0023469    .0009951
     ln_pop1849civil |   .0003659   .0007611     0.48   0.631    -.0011316    .0018635
  ln_pop1849military |   .0004009    .000237     1.69   0.092    -.0000653    .0008672
   fac1849_total2_pc |   .0108591   .0046684     2.33   0.021     .0016733    .0200449
       county_mining |   .0069377   .0018259     3.80   0.000      .003345    .0105304
county_landownership |   .0418399   .0137674     3.04   0.003     .0147503    .0689296
    pop1849_young_pc |   .0132942   .0096382     1.38   0.169    -.0056706    .0322591
   edu1849_pri_enrol |  -.0013435   .0013982    -0.96   0.337    -.0040947    .0014077
               dist1 |   .0013646   .0004106     3.32   0.001     .0005567    .0021725
               _cons |  -.0050394   .0076105    -0.66   0.508    -.0200144    .0099356
--------------------------------------------------------------------------------------

. 
. ********************************************************
. * Q.5 IV Regression
. 
. // column (1) of panel B and C
. ivreg2 gr_1831_1837 (rail1848=slc1848) gr_1816_1831 $control if node1848==0 ///
>  & areachange1==., cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    896
Number of clusters (kreiskey1849) =    308
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .5265572     .09718     5.42   0.000     .3358265     .717288
        gr_1816_1831 |   1.107491   .8439896     1.31   0.190    -.5489684    2.763951
    street1848_dummy |   .0002239   .0178319     0.01   0.990    -.0347739    .0352218
      ship1849_dummy |   .0010836   .0221451     0.05   0.961    -.0423795    .0445468
     ln_pop1849civil |   .0786635   .0184847     4.26   0.000     .0423844    .1149427
  ln_pop1849military |   .0009417   .0063917     0.15   0.883     -.011603    .0134864
   fac1849_total2_pc |    .021562   .0813176     0.27   0.791    -.1380364    .1811603
       county_mining |  -.0260875    .040573    -0.64   0.520    -.1057182    .0535433
county_landownership |   .1024004   .2725105     0.38   0.707    -.4324436    .6372443
    pop1849_young_pc |  -.2266483   .2427591    -0.93   0.351    -.7031004    .2498038
   edu1849_pri_enrol |   .0210865   .0268267     0.79   0.432    -.0315651     .073738
               dist1 |  -.0415033   .0092667    -4.48   0.000    -.0596906    -.023316
               _cons |   -.486961   .1635496    -2.98   0.003    -.8079523   -.1659698
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   307) =    29.36
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   307) =    29.36
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   307)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   307)
rail1848     |      29.36    0.0000 |       29.85   0.0000 |       29.36

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=15.81    P-val=0.0001

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                     122.45
Kleibergen-Paap Wald rk F statistic                                29.36

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,307)=       0.00     P-val=0.9708
Anderson-Rubin Wald test           Chi-sq(1)=      0.00     P-val=0.9705
Stock-Wright LM S statistic        Chi-sq(1)=      0.00     P-val=0.9681

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        308
Number of observations               N  =        896
Number of regressors                 K  =         13
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         13
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    308            Number of obs =      896
                                                      F( 12,   307) =     2.74
                                                      Prob > F      =   0.0015
Total (centered) SS     =  .1464935386                Centered R2   =   0.0402
Total (uncentered) SS   =   .311359116                Uncentered R2 =   0.5484
Residual SS             =  .1406043925                Root MSE      =   .01253

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |  -.0002177   .0058961    -0.04   0.971    -.0117738    .0113384
        gr_1816_1831 |   -.076104   .0705037    -1.08   0.280    -.2142886    .0620807
    street1848_dummy |   .0006084   .0009514     0.64   0.522    -.0012562    .0024731
      ship1849_dummy |  -.0017591   .0009826    -1.79   0.073    -.0036849    .0001667
     ln_pop1849civil |   .0012505   .0010666     1.17   0.241    -.0008399     .003341
  ln_pop1849military |   .0004803   .0003461     1.39   0.165     -.000198    .0011586
   fac1849_total2_pc |   .0076797   .0036497     2.10   0.035     .0005263     .014833
       county_mining |  -.0017611   .0014531    -1.21   0.226    -.0046091    .0010868
county_landownership |  -.0031254   .0188209    -0.17   0.868    -.0400136    .0337629
    pop1849_young_pc |   .0569194   .0156478     3.64   0.000     .0262502    .0875886
   edu1849_pri_enrol |  -.0022331   .0020198    -1.11   0.269    -.0061918    .0017256
               dist1 |   -.000712   .0006181    -1.15   0.249    -.0019235    .0004996
               _cons |  -.0130484    .010313    -1.27   0.206    -.0332614    .0071647
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             15.809
                                                   Chi-sq(1) P-val =    0.0001
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              122.453
                         (Kleibergen-Paap rk Wald F statistic):         29.359
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: gr_1816_1831 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848
------------------------------------------------------------------------------

. 
. // column (2) of panel B and C
. ivreg2 gr_1849_1871 (rail1848=slc1848) addrail71 gr_1831_1837 /// 
>  $control if node1848==0 & areachange2>1871, cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    902
Number of clusters (kreiskey1849) =    310
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .5533817   .0895944     6.18   0.000     .3775403    .7292231
           addrail71 |  -.1594114   .0214485    -7.43   0.000    -.2015071   -.1173157
        gr_1831_1837 |   .3530613   .5664252     0.62   0.533    -.7586269    1.464749
    street1848_dummy |   .0219758   .0179222     1.23   0.220     -.013199    .0571506
      ship1849_dummy |   .0043215   .0214936     0.20   0.841    -.0378627    .0465058
     ln_pop1849civil |    .101204   .0189509     5.34   0.000     .0640102    .1383978
  ln_pop1849military |    .000849   .0063858     0.13   0.894     -.011684    .0133821
   fac1849_total2_pc |   .0658161   .1062197     0.62   0.536    -.1426549     .274287
       county_mining |    .030715   .0423892     0.72   0.469    -.0524797    .1139096
county_landownership |  -.2162987   .2742923    -0.79   0.431    -.7546354    .3220381
    pop1849_young_pc |  -.2331869   .2442494    -0.95   0.340    -.7125602    .2461865
   edu1849_pri_enrol |   .0295289   .0288586     1.02   0.306    -.0271101    .0861678
               dist1 |  -.0343018    .008448    -4.06   0.000    -.0508823   -.0177214
               _cons |  -.6288927   .1694502    -3.71   0.000    -.9614622   -.2963231
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   309) =    38.15
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   309) =    38.15
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   309)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   309)
rail1848     |      38.15    0.0000 |       38.83   0.0000 |       38.15

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=16.33    P-val=0.0001

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                     137.29
Kleibergen-Paap Wald rk F statistic                                38.15

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,309)=      10.94     P-val=0.0011
Anderson-Rubin Wald test           Chi-sq(1)=     11.13     P-val=0.0008
Stock-Wright LM S statistic        Chi-sq(1)=     15.25     P-val=0.0001

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        310
Number of observations               N  =        902
Number of regressors                 K  =         14
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         14
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    310            Number of obs =      902
                                                      F( 13,   309) =    10.49
                                                      Prob > F      =   0.0000
Total (centered) SS     =  .0954729332                Centered R2   =   0.1319
Total (uncentered) SS   =   .165560057                Uncentered R2 =   0.4994
Residual SS             =  .0828759094                Root MSE      =  .009585

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0209013   .0064754     3.23   0.001     .0082097    .0335928
           addrail71 |   .0071321    .001437     4.96   0.000     .0043156    .0099486
        gr_1831_1837 |   .0959946   .0269477     3.56   0.000     .0431782    .1488111
    street1848_dummy |   .0002582   .0007437     0.35   0.728    -.0011994    .0017158
      ship1849_dummy |  -.0008273   .0008419    -0.98   0.326    -.0024774    .0008227
     ln_pop1849civil |  -.0009016   .0009815    -0.92   0.358    -.0028254    .0010222
  ln_pop1849military |   .0003988   .0002549     1.56   0.118    -.0001008    .0008983
   fac1849_total2_pc |   .0100835    .004208     2.40   0.017     .0018361     .018331
       county_mining |   .0061272   .0015922     3.85   0.000     .0030064    .0092479
county_landownership |   .0440182   .0141845     3.10   0.002      .016217    .0718193
    pop1849_young_pc |   .0168834   .0104066     1.62   0.105    -.0035132    .0372799
   edu1849_pri_enrol |  -.0017899   .0014043    -1.27   0.202    -.0045422    .0009624
               dist1 |   .0018718   .0005185     3.61   0.000     .0008556    .0028881
               _cons |   .0025312   .0080017     0.32   0.752    -.0131519    .0182143
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             16.331
                                                   Chi-sq(1) P-val =    0.0001
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              137.294
                         (Kleibergen-Paap rk Wald F statistic):         38.149
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: addrail71 gr_1831_1837 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848
------------------------------------------------------------------------------

. 
. // HOMEWORK: use slc1848_lcp_1_5km (least cost path) as an alternative 
. // instrument and briefly comment on it, whether other instruments would
. // predict the same.
. 
. // column (1) of panel B and C
. ivreg2 gr_1831_1837 (rail1848=slc1848_lcp_1_5km) gr_1816_1831 $control ///
> if node1848==0 & areachange1==., cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    896
Number of clusters (kreiskey1849) =    308
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
   slc1848_lcp_1_5km |   .3368901   .1002923     3.36   0.001     .1400509    .5337293
        gr_1816_1831 |   1.799551    .893546     2.01   0.044     .0458294    3.553273
    street1848_dummy |   .0107688   .0178757     0.60   0.547     -.024315    .0458527
      ship1849_dummy |   .0050097   .0223506     0.22   0.823    -.0388567    .0488762
     ln_pop1849civil |   .0808803    .019949     4.05   0.000     .0417273    .1200333
  ln_pop1849military |  -.0014295   .0067076    -0.21   0.831    -.0145941    .0117352
   fac1849_total2_pc |   .0273253   .0820174     0.33   0.739    -.1336465    .1882972
       county_mining |  -.0029804   .0409611    -0.07   0.942    -.0833729    .0774121
county_landownership |   .2017075   .2764034     0.73   0.466    -.3407768    .7441918
    pop1849_young_pc |  -.3275888   .2606486    -1.26   0.209    -.8391518    .1839743
   edu1849_pri_enrol |   .0320123   .0231153     1.38   0.166    -.0133549    .0773796
               dist1 |  -.0469095   .0094049    -4.99   0.000    -.0653681    -.028451
               _cons |  -.4827357   .1808283    -2.67   0.008     -.837639   -.1278323
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   307) =    11.28
  Prob > F      =   0.0009
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   307) =    11.28
  Prob > F      =   0.0009



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   307)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   307)
rail1848     |      11.28    0.0009 |       11.47   0.0007 |       11.28

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=8.07     P-val=0.0045

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                      38.39
Kleibergen-Paap Wald rk F statistic                                11.28

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,307)=       0.50     P-val=0.4807
Anderson-Rubin Wald test           Chi-sq(1)=      0.51     P-val=0.4765
Stock-Wright LM S statistic        Chi-sq(1)=      0.54     P-val=0.4631

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        308
Number of observations               N  =        896
Number of regressors                 K  =         13
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         13
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    308            Number of obs =      896
                                                      F( 12,   307) =     2.72
                                                      Prob > F      =   0.0016
Total (centered) SS     =  .1464935386                Centered R2   =   0.0398
Total (uncentered) SS   =   .311359116                Uncentered R2 =   0.5482
Residual SS             =  .1406638632                Root MSE      =   .01253

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0041524   .0057978     0.72   0.474     -.007211    .0155159
        gr_1816_1831 |  -.0854569   .0709582    -1.20   0.228    -.2245324    .0536186
    street1848_dummy |   .0005724   .0009418     0.61   0.543    -.0012735    .0024183
      ship1849_dummy |  -.0018003   .0009854    -1.83   0.068    -.0037315     .000131
     ln_pop1849civil |   .0008762   .0010522     0.83   0.405     -.001186    .0029385
  ln_pop1849military |   .0004861   .0003448     1.41   0.159    -.0001897    .0011619
   fac1849_total2_pc |   .0075827   .0036448     2.08   0.037      .000439    .0147263
       county_mining |  -.0017453   .0014997    -1.16   0.245    -.0046847    .0011942
county_landownership |  -.0035769   .0187571    -0.19   0.849    -.0403402    .0331863
    pop1849_young_pc |     .05844   .0157016     3.72   0.000     .0276654    .0892146
   edu1849_pri_enrol |  -.0024121   .0020203    -1.19   0.233    -.0063719    .0015477
               dist1 |  -.0004905   .0006295    -0.78   0.436    -.0017244    .0007433
               _cons |  -.0108093   .0101558    -1.06   0.287    -.0307142    .0090956
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              8.066
                                                   Chi-sq(1) P-val =    0.0045
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):               38.387
                         (Kleibergen-Paap rk Wald F statistic):         11.283
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: gr_1816_1831 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848_lcp_1_5km
------------------------------------------------------------------------------

. 
. // column (2) of panel B and C
. ivreg2 gr_1849_1871 (rail1848=slc1848_lcp_1_5km) addrail71 gr_1831_1837 /// 
>  $control if node1848==0 & areachange2>1871, cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    902
Number of clusters (kreiskey1849) =    310
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
   slc1848_lcp_1_5km |   .3150942   .0959411     3.28   0.001     .1267964    .5033919
           addrail71 |  -.1815273   .0215268    -8.43   0.000    -.2237767    -.139278
        gr_1831_1837 |   .2248451   .6746779     0.33   0.739    -1.099304    1.548994
    street1848_dummy |   .0348462   .0180889     1.93   0.054    -.0006557    .0703481
      ship1849_dummy |    .008727   .0219128     0.40   0.691    -.0342799     .051734
     ln_pop1849civil |   .1043121    .019477     5.36   0.000     .0660859    .1425383
  ln_pop1849military |  -.0003018   .0066408    -0.05   0.964    -.0133353    .0127318
   fac1849_total2_pc |   .0746253   .1134341     0.66   0.511     -.148005    .2972556
       county_mining |   .0700679   .0471548     1.49   0.138      -.02248    .1626157
county_landownership |  -.1050888   .2774466    -0.38   0.705    -.6496164    .4394388
    pop1849_young_pc |  -.3051424    .270744    -1.13   0.260    -.8365152    .2262304
   edu1849_pri_enrol |   .0271693   .0297192     0.91   0.361    -.0311587    .0854973
               dist1 |   -.040696   .0087433    -4.65   0.000     -.057856    -.023536
               _cons |  -.6166019   .1757815    -3.51   0.000    -.9615976   -.2716063
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   309) =    10.79
  Prob > F      =   0.0011
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   309) =    10.79
  Prob > F      =   0.0011



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   309)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   309)
rail1848     |      10.79    0.0011 |       10.98   0.0009 |       10.79

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=7.83     P-val=0.0051

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                      33.68
Kleibergen-Paap Wald rk F statistic                                10.79

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,309)=       5.52     P-val=0.0195
Anderson-Rubin Wald test           Chi-sq(1)=      5.61     P-val=0.0178
Stock-Wright LM S statistic        Chi-sq(1)=      5.44     P-val=0.0197

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        310
Number of observations               N  =        902
Number of regressors                 K  =         14
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         14
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    310            Number of obs =      902
                                                      F( 13,   309) =    10.74
                                                      Prob > F      =   0.0000
Total (centered) SS     =  .0954729332                Centered R2   =   0.1491
Total (uncentered) SS   =   .165560057                Uncentered R2 =   0.5093
Residual SS             =  .0812390655                Root MSE      =   .00949

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0195941   .0076479     2.56   0.010     .0046045    .0345837
           addrail71 |    .006888   .0016872     4.08   0.000     .0035812    .0101949
        gr_1831_1837 |   .0963495   .0268007     3.60   0.000     .0438211     .148878
    street1848_dummy |   .0003015   .0008179     0.37   0.712    -.0013015    .0019046
      ship1849_dummy |  -.0008103   .0008344    -0.97   0.332    -.0024456    .0008251
     ln_pop1849civil |  -.0007587   .0011455    -0.66   0.508    -.0030038    .0014865
  ln_pop1849military |    .000399   .0002511     1.59   0.112    -.0000932    .0008912
   fac1849_total2_pc |    .010171   .0042952     2.37   0.018     .0017525    .0185895
       county_mining |   .0062186   .0019179     3.24   0.001     .0024595    .0099776
county_landownership |   .0437726   .0141579     3.09   0.002     .0160237    .0715215
    pop1849_young_pc |   .0164786   .0099079     1.66   0.096    -.0029405    .0358978
   edu1849_pri_enrol |  -.0017396   .0014523    -1.20   0.231    -.0045859    .0011068
               dist1 |   .0018146   .0005116     3.55   0.000     .0008119    .0028173
               _cons |   .0016776   .0093599     0.18   0.858    -.0166676    .0200227
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):              7.835
                                                   Chi-sq(1) P-val =    0.0051
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):               33.675
                         (Kleibergen-Paap rk Wald F statistic):         10.786
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: addrail71 gr_1831_1837 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848_lcp_1_5km
------------------------------------------------------------------------------

. 
. /* The overall general results do not change by using the new IV of least 
> cost corridor, but the magnitude of the effect of railroad connection on growth
> as well as the statistical significance, declines (magnitude of effect from 
> 2.1% to 1.96%, and lower significance level but still strongly significant).
> 
> The new IV is a weaker instrument, due to much lower F-values and weak 
> identification tests like Cragg-Donald or Kleibergen-Paap Wald.  This can 
> also be seen in the first stage IV regression with the coefficient dropping from
> .53 to .34 using the new IV of least cost path.  One reason for this may be due
> to the larger corridor area.  The original IV uses a corridor of 1 km, and the
> new IV expands the corridor to 1.5km.  
> 
> The exclusion restriction, that the covariance between the instrument and the
> error term 0 or close to it cannot be tested.  But given this is a wider 
> corridor, and also a weaker instrument, it is very possible that this 
> restriction wouldn't hold for this IV.
> 
> It seems the corridor measurement, whichever is used, is correlated with 
> several other city characteristics like roads, mining, higher ex ante 
> populations and commmercial density, so other instruments likely have a similar 
> problem.
> */ 
. 
. ********************************************************
. * Q.6 
. 
. // HOMEWORK: Restimate column (1) and (2) for OLS + IV
. // constrain on those that never incorporated other areas through 1871
. // want first and second estimation sample to be the same
. // we want to have the same sample in both and briefly comment on if its the
. // same or if we see differences. 
. 
. * Column 1 panel A
. reg gr_1831_1837 rail1848 gr_1816_1831 $control if node1848==0 ///
>  & areachange1==. & areachange2>=1872 ///
>  & gr_1849_1871!=. & addrail71!=. & gr_1831_1837!=., cluster(kreiskey1849)

Linear regression                               Number of obs     =        880
                                                F(12, 305)        =       2.82
                                                Prob > F          =     0.0011
                                                R-squared         =     0.0402
                                                Root MSE          =     .01253

                                 (Std. Err. adjusted for 306 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0018497   .0017778     1.04   0.299    -.0016485    .0053479
        gr_1816_1831 |  -.0659103   .0706497    -0.93   0.352    -.2049327    .0731122
    street1848_dummy |   .0006223   .0009716     0.64   0.522    -.0012897    .0025342
      ship1849_dummy |  -.0017395   .0010073    -1.73   0.085    -.0037218    .0002427
     ln_pop1849civil |   .0010891   .0009834     1.11   0.269     -.000846    .0030241
  ln_pop1849military |   .0005054   .0003571     1.42   0.158    -.0001974    .0012081
   fac1849_total2_pc |   .0059894   .0044173     1.36   0.176    -.0027027    .0146816
       county_mining |  -.0015829   .0014861    -1.07   0.288    -.0045072    .0013414
county_landownership |  -.0057615   .0191479    -0.30   0.764    -.0434401    .0319172
    pop1849_young_pc |   .0613579   .0166297     3.69   0.000     .0286345    .0940813
   edu1849_pri_enrol |  -.0024973    .001957    -1.28   0.203    -.0063482    .0013536
               dist1 |  -.0005939   .0005727    -1.04   0.301    -.0017208     .000533
               _cons |  -.0134303   .0102367    -1.31   0.191    -.0335739    .0067133
--------------------------------------------------------------------------------------

. 
.  * Column 1 panel B & C
. ivreg2 gr_1831_1837 (rail1848=slc1848) gr_1816_1831 $control if node1848==0 ///
>  & areachange1==. & areachange2>=1872  ///
>  & gr_1849_1871!=. & addrail71!=. & gr_1831_1837!=., cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    880
Number of clusters (kreiskey1849) =    306
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .5742308   .0924639     6.21   0.000     .3927516      .75571
        gr_1816_1831 |   1.187918   .8486574     1.40   0.162     -.477745    2.853581
    street1848_dummy |    .001286   .0180518     0.07   0.943    -.0341443    .0367163
      ship1849_dummy |  -.0006331   .0225455    -0.03   0.978    -.0448832     .043617
     ln_pop1849civil |   .0829916   .0197878     4.19   0.000      .044154    .1218293
  ln_pop1849military |  -.0002179   .0067232    -0.03   0.974    -.0134136    .0129777
   fac1849_total2_pc |   .0621635   .1074626     0.58   0.563    -.1487538    .2730808
       county_mining |  -.0316151   .0409193    -0.77   0.440    -.1119277    .0486974
county_landownership |   .0605838   .2748483     0.22   0.826    -.4788619    .6000296
    pop1849_young_pc |  -.2218558   .2568037    -0.86   0.388    -.7258854    .2821738
   edu1849_pri_enrol |    .045114   .0274277     1.64   0.100    -.0087184    .0989464
               dist1 |   -.038323   .0091795    -4.17   0.000    -.0563397   -.0203063
               _cons |  -.5444227   .1843568    -2.95   0.003    -.9062605   -.1825849
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   305) =    38.57
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   305) =    38.57
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   305)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   305)
rail1848     |      38.57    0.0000 |       39.23   0.0000 |       38.57

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=16.46    P-val=0.0000

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                     135.74
Kleibergen-Paap Wald rk F statistic                                38.57

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,305)=       0.03     P-val=0.8642
Anderson-Rubin Wald test           Chi-sq(1)=      0.03     P-val=0.8629
Stock-Wright LM S statistic        Chi-sq(1)=      0.04     P-val=0.8502

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        306
Number of observations               N  =        880
Number of regressors                 K  =         13
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         13
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    306            Number of obs =      880
                                                      F( 12,   305) =     2.68
                                                      Prob > F      =   0.0019
Total (centered) SS     =  .1418339909                Centered R2   =   0.0399
Total (uncentered) SS   =  .3038926938                Uncentered R2 =   0.5519
Residual SS             =  .1361737967                Root MSE      =   .01244

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0009831   .0057019     0.17   0.863    -.0101924    .0121586
        gr_1816_1831 |  -.0640452    .071554    -0.90   0.371    -.2042885     .076198
    street1848_dummy |   .0006302   .0009712     0.65   0.516    -.0012734    .0025338
      ship1849_dummy |   -.001731   .0010014    -1.73   0.084    -.0036938    .0002317
     ln_pop1849civil |   .0011654   .0010842     1.07   0.282    -.0009597    .0032905
  ln_pop1849military |   .0005036   .0003542     1.42   0.155    -.0001906    .0011979
   fac1849_total2_pc |   .0060387   .0043855     1.38   0.169    -.0025567    .0146341
       county_mining |  -.0015873   .0014704    -1.08   0.280    -.0044692    .0012945
county_landownership |  -.0056916   .0189711    -0.30   0.764    -.0428742     .031491
    pop1849_young_pc |   .0610533   .0164749     3.71   0.000     .0287631    .0933434
   edu1849_pri_enrol |  -.0024552   .0019691    -1.25   0.212    -.0063145    .0014042
               dist1 |  -.0006369   .0006065    -1.05   0.294    -.0018257    .0005518
               _cons |  -.0138952   .0107278    -1.30   0.195    -.0349214    .0071309
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             16.456
                                                   Chi-sq(1) P-val =    0.0000
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              135.738
                         (Kleibergen-Paap rk Wald F statistic):         38.568
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: gr_1816_1831 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848
------------------------------------------------------------------------------

. 
.  * Column 1 panel D
. reg gr_1831_1837 slc1848 gr_1816_1831 $control if node1848==0 ///
>  & areachange1==. & areachange2>1871   ///
>  & gr_1849_1871!=. & addrail71!=. & gr_1831_1837!=., cluster(kreiskey1849)

Linear regression                               Number of obs     =        880
                                                F(12, 305)        =       2.69
                                                Prob > F          =     0.0018
                                                R-squared         =     0.0389
                                                Root MSE          =     .01254

                                 (Std. Err. adjusted for 306 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1831_1837 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .0005645   .0032971     0.17   0.864    -.0059234    .0070524
        gr_1816_1831 |  -.0628774   .0709982    -0.89   0.377    -.2025858    .0768309
    street1848_dummy |   .0006315   .0009787     0.65   0.519    -.0012943    .0025573
      ship1849_dummy |  -.0017317    .001009    -1.72   0.087    -.0037172    .0002539
     ln_pop1849civil |    .001247   .0009562     1.30   0.193    -.0006346    .0031286
  ln_pop1849military |   .0005034   .0003576     1.41   0.160    -.0002002     .001207
   fac1849_total2_pc |   .0060999   .0044178     1.38   0.168    -.0025934    .0147931
       county_mining |  -.0016184   .0014291    -1.13   0.258    -.0044306    .0011938
county_landownership |   -.005632   .0191846    -0.29   0.769     -.043383    .0321189
    pop1849_young_pc |   .0608352   .0165966     3.67   0.000     .0281768    .0934936
   edu1849_pri_enrol |  -.0024108   .0019594    -1.23   0.220    -.0062665    .0014449
               dist1 |  -.0006746   .0005637    -1.20   0.232    -.0017839    .0004347
               _cons |  -.0144304   .0101548    -1.42   0.156    -.0344128    .0055519
--------------------------------------------------------------------------------------

. 
. /*  Our sample size drops to 880.  There aren't any substantitive changes.
> The most notable whould be the increase in the coefficient in the first stage
> of the IV regression, panel B from 0.531 to 0.574 with stronger F stats and
> stronger weak identification test results indicating that the IV is slightly
> more powerful with this sample.  
> Rail access 1838-48 does decline slightly from .002 to .00185 or .0019.
> Otherwise, most of the coefficients only change by 1/1000, or .1% if at all.
> Statitstical significance levels remain pretty similar.
> */
. 
.  * Column 2 panel A
. reg gr_1849_1871 rail1848 addrail71 gr_1831_1837 $control if node1848==0 ///
>  & areachange1==. & areachange2>=1872 ///
>  & gr_1831_1837!=. & gr_1816_1831!=., cluster(kreiskey1849)

Linear regression                               Number of obs     =        880
                                                F(13, 305)        =      14.86
                                                Prob > F          =     0.0000
                                                R-squared         =     0.2201
                                                Root MSE          =     .00858

                                 (Std. Err. adjusted for 306 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0083348   .0014251     5.85   0.000     .0055306    .0111391
           addrail71 |    .005071   .0008814     5.75   0.000     .0033367    .0068054
        gr_1831_1837 |   .1048394   .0249677     4.20   0.000     .0557087    .1539702
    street1848_dummy |  -.0000616   .0006674    -0.09   0.927    -.0013748    .0012516
      ship1849_dummy |  -.0002815   .0008367    -0.34   0.737    -.0019279    .0013649
     ln_pop1849civil |   .0007293   .0007141     1.02   0.308    -.0006758    .0021345
  ln_pop1849military |   .0003883   .0002355     1.65   0.100     -.000075    .0008517
   fac1849_total2_pc |   .0083132   .0035786     2.32   0.021     .0012712    .0153551
       county_mining |   .0064752   .0015829     4.09   0.000     .0033604      .00959
county_landownership |   .0466076    .013456     3.46   0.001     .0201294    .0730859
    pop1849_young_pc |   .0130234   .0091474     1.42   0.156    -.0049766    .0310233
   edu1849_pri_enrol |  -.0012328   .0014263    -0.86   0.388    -.0040394    .0015737
               dist1 |   .0013192   .0004043     3.26   0.001     .0005237    .0021147
               _cons |  -.0078622   .0072377    -1.09   0.278    -.0221043      .00638
--------------------------------------------------------------------------------------

. 
.  * Column 2 panel B & C
. ivreg2 gr_1849_1871 (rail1848=slc1848) addrail71 gr_1831_1837 /// 
>  $control if node1848==0 & areachange1==. & areachange2>=1872   ///
>  & gr_1831_1837!=. & gr_1816_1831!=., ///
>  cluster(kreiskey1849) first

First-stage regressions
-----------------------


First-stage regression of rail1848:

Statistics robust to heteroskedasticity and clustering on kreiskey1849
Number of obs =                    880
Number of clusters (kreiskey1849) =    306
--------------------------------------------------------------------------------------
                     |               Robust
            rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .5412604   .0898412     6.02   0.000     .3649283    .7175925
           addrail71 |  -.1510927   .0202213    -7.47   0.000    -.1907812   -.1114043
        gr_1831_1837 |   .3864497   .5696552     0.68   0.498    -.7316165    1.504516
    street1848_dummy |   .0197211   .0180501     1.09   0.275     -.015706    .0551483
      ship1849_dummy |   .0029437   .0214273     0.14   0.891    -.0391119    .0449993
     ln_pop1849civil |   .0991975   .0194194     5.11   0.000     .0610828    .1373122
  ln_pop1849military |   .0020361   .0065163     0.31   0.755    -.0107535    .0148257
   fac1849_total2_pc |   .0423589   .1003957     0.42   0.673    -.1546884    .2394062
       county_mining |  -.0026701   .0378437    -0.07   0.944    -.0769462    .0716061
county_landownership |  -.1399143   .2689713    -0.52   0.603    -.6678262    .3879975
    pop1849_young_pc |  -.2860117   .2479223    -1.15   0.249    -.7726107    .2005872
   edu1849_pri_enrol |    .037548    .028201     1.33   0.183    -.0178023    .0928983
               dist1 |  -.0346555   .0084827    -4.09   0.000    -.0513045   -.0180065
               _cons |  -.6079131   .1739891    -3.49   0.001    -.9494027   -.2664234
--------------------------------------------------------------------------------------
F test of excluded instruments:
  F(  1,   305) =    36.30
  Prob > F      =   0.0000
Sanderson-Windmeijer multivariate F test of excluded instruments:
  F(  1,   305) =    36.30
  Prob > F      =   0.0000



Summary results for first-stage regressions
-------------------------------------------

                                           (Underid)            (Weak id)
Variable     | F(  1,   305)  P-val | SW Chi-sq(  1) P-val | SW F(  1,   305)
rail1848     |      36.30    0.0000 |       36.96   0.0000 |       36.30

NB: first-stage test statistics cluster-robust

Stock-Yogo weak ID F test critical values for single endogenous regressor:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for i.i.d. errors only.

Underidentification test
Ho: matrix of reduced form coefficients has rank=K1-1 (underidentified)
Ha: matrix has rank=K1 (identified)
Kleibergen-Paap rk LM statistic          Chi-sq(1)=16.28    P-val=0.0001

Weak identification test
Ho: equation is weakly identified
Cragg-Donald Wald F statistic                                     127.70
Kleibergen-Paap Wald rk F statistic                                36.30

Stock-Yogo weak ID test critical values for K1=1 and L1=1:
                                   10% maximal IV size             16.38
                                   15% maximal IV size              8.96
                                   20% maximal IV size              6.66
                                   25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.

Weak-instrument-robust inference
Tests of joint significance of endogenous regressors B1 in main equation
Ho: B1=0 and orthogonality conditions are valid
Anderson-Rubin Wald test           F(1,305)=       9.70     P-val=0.0020
Anderson-Rubin Wald test           Chi-sq(1)=      9.88     P-val=0.0017
Stock-Wright LM S statistic        Chi-sq(1)=     11.24     P-val=0.0008

NB: Underidentification, weak identification and weak-identification-robust
    test statistics cluster-robust

Number of clusters             N_clust  =        306
Number of observations               N  =        880
Number of regressors                 K  =         14
Number of endogenous regressors      K1 =          1
Number of instruments                L  =         14
Number of excluded instruments       L1 =          1

IV (2SLS) estimation
--------------------

Estimates efficient for homoskedasticity only
Statistics robust to heteroskedasticity and clustering on kreiskey1849

Number of clusters (kreiskey1849) =    306            Number of obs =      880
                                                      F( 13,   305) =    11.55
                                                      Prob > F      =   0.0000
Total (centered) SS     =  .0816640348                Centered R2   =   0.1347
Total (uncentered) SS   =  .1461198207                Uncentered R2 =   0.5164
Residual SS             =  .0706617247                Root MSE      =  .008961

--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
            rail1848 |   .0197731   .0064025     3.09   0.002     .0072244    .0323219
           addrail71 |   .0070831   .0014779     4.79   0.000     .0041864    .0099798
        gr_1831_1837 |   .1007085   .0259263     3.88   0.000      .049894    .1515231
    street1848_dummy |  -.0004018   .0006867    -0.59   0.558    -.0017477    .0009441
      ship1849_dummy |  -.0004274   .0008131    -0.53   0.599    -.0020212    .0011663
     ln_pop1849civil |  -.0004923    .000922    -0.53   0.593    -.0022994    .0013147
  ln_pop1849military |   .0003718   .0002512     1.48   0.139    -.0001206    .0008643
   fac1849_total2_pc |   .0079486   .0034723     2.29   0.022     .0011429    .0147542
       county_mining |   .0061665   .0014577     4.23   0.000     .0033095    .0090236
county_landownership |   .0480442   .0137572     3.49   0.000     .0210805    .0750079
    pop1849_young_pc |   .0172657   .0100827     1.71   0.087    -.0024961    .0370274
   edu1849_pri_enrol |  -.0016771   .0014205    -1.18   0.238    -.0044612    .0011069
               dist1 |   .0018297   .0005151     3.55   0.000     .0008201    .0028394
               _cons |  -.0007915   .0075089    -0.11   0.916    -.0155087    .0139256
--------------------------------------------------------------------------------------
Underidentification test (Kleibergen-Paap rk LM statistic):             16.277
                                                   Chi-sq(1) P-val =    0.0001
------------------------------------------------------------------------------
Weak identification test (Cragg-Donald Wald F statistic):              127.698
                         (Kleibergen-Paap rk Wald F statistic):         36.296
Stock-Yogo weak ID test critical values: 10% maximal IV size             16.38
                                         15% maximal IV size              8.96
                                         20% maximal IV size              6.66
                                         25% maximal IV size              5.53
Source: Stock-Yogo (2005).  Reproduced by permission.
NB: Critical values are for Cragg-Donald F statistic and i.i.d. errors.
------------------------------------------------------------------------------
Hansen J statistic (overidentification test of all instruments):         0.000
                                                 (equation exactly identified)
------------------------------------------------------------------------------
Instrumented:         rail1848
Included instruments: addrail71 gr_1831_1837 street1848_dummy ship1849_dummy
                      ln_pop1849civil ln_pop1849military fac1849_total2_pc
                      county_mining county_landownership pop1849_young_pc
                      edu1849_pri_enrol dist1
Excluded instruments: slc1848
------------------------------------------------------------------------------

. 
.  * Column 2 panel D
. reg gr_1849_1871 slc1848 addrail71 gr_1831_1837 $control if node1848==0 ///
>  & areachange1==. & areachange2>=1872  ///
>  & gr_1831_1837!=. & gr_1816_1831!=., cluster(kreiskey1849)

Linear regression                               Number of obs     =        880
                                                F(13, 305)        =      13.13
                                                Prob > F          =     0.0000
                                                R-squared         =     0.2075
                                                Root MSE          =     .00864

                                 (Std. Err. adjusted for 306 clusters in kreiskey1849)
--------------------------------------------------------------------------------------
                     |               Robust
        gr_1849_1871 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
---------------------+----------------------------------------------------------------
             slc1848 |   .0107024   .0034357     3.12   0.002     .0039418     .017463
           addrail71 |   .0040955   .0009206     4.45   0.000     .0022841     .005907
        gr_1831_1837 |   .1083498   .0246719     4.39   0.000     .0598012    .1568985
    street1848_dummy |  -.0000119   .0006824    -0.02   0.986    -.0013546    .0013308
      ship1849_dummy |  -.0003692   .0008854    -0.42   0.677    -.0021114    .0013729
     ln_pop1849civil |   .0014691   .0007502     1.96   0.051    -7.17e-06    .0029454
  ln_pop1849military |   .0004121   .0002337     1.76   0.079    -.0000479    .0008721
   fac1849_total2_pc |   .0087862   .0038413     2.29   0.023     .0012274    .0163449
       county_mining |   .0061137    .001636     3.74   0.000     .0028945     .009333
county_landownership |   .0452777   .0135884     3.33   0.001     .0185387    .0720166
    pop1849_young_pc |   .0116103    .009361     1.24   0.216      -.00681    .0300306
   edu1849_pri_enrol |  -.0009347   .0014024    -0.67   0.506    -.0036943    .0018249
               dist1 |   .0011445   .0004172     2.74   0.006     .0003235    .0019654
               _cons |  -.0128119   .0074116    -1.73   0.085    -.0273962    .0017724
--------------------------------------------------------------------------------------

. 
. /*  We have the same sample size of 880.  The coefficients across the board
> for all 4 panels do decline some, but not by a lot, mostly by 1/1000 or so
> except for Panel B first stage IV declines from .553 to .541 and the same
> with the weak identification numbers and F tests, indicating the IV is a little
> weaker for this sample for the period in column 2, but not qualititatively.
> Statistical significance levels remain pretty similar.  
> So overall, qualitatively, not much changes with this slightly more restricted 
> sample.
> */
. 
. ********************************************************
. * Q.7 Prior on Propensity Score Matching and Non-Linear Models
. 
. gen gr_1821_1837 = ( ln(pop1837civil)-ln(pop1821civil) ) / (1837-1821)
(44 missing values generated)

. replace gr_1821_1837 = . if abs(gr_1821_1837)>=0.1
(0 real changes made)

. 
. global exantecontrols ln_pop1837civil gr_1821_1837 occ1819_merch_pc ///
>  loom1819_city_pc pop1816_prot_pc buil1821_home_city_pc buil1821_fac_city_pc ///
>  ln_assu1821_value_city_ph

. 
. tabstat $exantecontrols if city!="Waldenburg", by(indi_sum) stats(mean sd N)

Summary statistics: mean, sd, N
  by categories of: indi_sum 

indi_sum |  l~7civil  gr_182~7  occ181~c  loom18~c  pop181~c  b~home~c  b~fac_~c  ln_ass~h
---------+--------------------------------------------------------------------------------
       0 |  9.630809  .0159707   .015734  .0134099  .6083201  .1046468  .0051775   6.33826
         |  1.093495  .0090669  .0056367  .0198596  .3750709  .0421969  .0066978  .8444494
         |        29        29        28        28        28        29        29        29
---------+--------------------------------------------------------------------------------
       1 |  8.167605  .0147857  .0162673  .0173131   .786159  .1299316  .0046882  5.805752
         |  .7689839  .0064835  .0106109  .0185577  .3255738  .0266716  .0052263  .6402978
         |        76        68        62        62        65        67        67        67
---------+--------------------------------------------------------------------------------
       2 |  7.665192  .0120937  .0146322  .0193548  .6263919   .138488  .0051469  5.385252
         |  .6833352  .0099588  .0100017  .0243642  .3997646  .0332486   .006438  .7102747
         |       861       836       793       797       828       845       844       819
---------+--------------------------------------------------------------------------------
   Total |  7.763728  .0124104   .014782  .0190244  .6371181  .1368358  .0051151  5.446247
         |  .7893432  .0097592  .0099393  .0238818  .3960523  .0336656  .0063626  .7355312
         |       966       933       883       887       921       941       940       915
------------------------------------------------------------------------------------------

. 
. estpost ttest $exantecontrols if node1848==0, by(rail1848)

             |      e(b)   e(count)      e(se)       e(t)    e(df_t)     e(p_l)       e(p)     e(p_u)     e(N_1)    e(mu_1)     e(N_2)    e(mu_2) 
-------------+------------------------------------------------------------------------------------------------------------------------------------
ln_pop1837~l | -.5024134        937   .0826392  -6.079598        935   8.77e-10   1.75e-09          1        861   7.665192         76   8.167605 
gr_1821_1837 |  -.002692        904   .0012287  -2.190977        902   .0143543   .0287087   .9856457        836   .0120937         68   .0147857 
occ1819_me~c | -.0016351        855   .0013248  -1.234174        853    .108739   .2174781    .891261        793   .0146322         62   .0162673 
loom1819_c~c |  .0020416        859    .003164   .6452679        857   .7405368   .5189263   .2594632        797   .0193548         62   .0173131 
pop1816_pr~c | -.1597671        893   .0508676  -3.140841        891   .0008701   .0017402   .9991299        828   .6263919         65    .786159 
buil1821_h~c |  .0085564        912    .004165   2.054353        910   .9798867   .0402267   .0201133        845    .138488         67   .1299316 
buil1821_f~c |  .0004587        911    .000807   .5684143        909   .7150529   .5698941   .2849471        844   .0051469         67   .0046882 
ln_assu182~h | -.4205002        886   .0896201  -4.692031        884   1.57e-06   3.13e-06   .9999984        819   5.385252         67   5.805752 

. * if we had linear probability model
. reg rail1848 $exantecontrols

      Source |       SS           df       MS      Number of obs   =       847
-------------+----------------------------------   F(8, 838)       =     19.79
       Model |  12.2798011         8  1.53497514   Prob > F        =    0.0000
    Residual |  64.9882036       838  .077551556   R-squared       =    0.1589
-------------+----------------------------------   Adj R-squared   =    0.1509
       Total |  77.2680047       846  .091333339   Root MSE        =    .27848

-------------------------------------------------------------------------------------------
                 rail1848 |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
          ln_pop1837civil |   .1354284   .0146326     9.26   0.000     .1067076    .1641491
             gr_1821_1837 |   2.250765   1.080044     2.08   0.037     .1308554    4.370674
         occ1819_merch_pc |   .8855072   .9622479     0.92   0.358    -1.003192    2.774206
         loom1819_city_pc |  -.3632843   .4147162    -0.88   0.381    -1.177289    .4507201
          pop1816_prot_pc |    .030863    .026331     1.17   0.241    -.0208194    .0825455
    buil1821_home_city_pc |  -.1587667   .3102424    -0.51   0.609    -.7677101    .4501767
     buil1821_fac_city_pc |  -.4569286    1.53352    -0.30   0.766    -3.466921    2.553064
ln_assu1821_value_city_ph |   .0125759   .0163691     0.77   0.443    -.0195534    .0447051
                    _cons |  -1.048725   .1290291    -8.13   0.000    -1.301983   -.7954665
-------------------------------------------------------------------------------------------

. * predict probabiltiy of being treated
. predict pscore 
(option xb assumed; fitted values)
(131 missing values generated)

. 
. twoway histogram pscore if rail1848==1 || ///
> histogram pscore if rail1848==0, color(red)

. 
. * Note: I'm not including a pdf of this chart for homework submission this week
. * since we are finisishing this next session.
. 
. * close the log file 
. log close
      name:  <unnamed>
       log:  C:\Users\roble\Desktop\Working\STATA\HW 11/leonard_exc11.log
  log type:  text
 closed on:  20 Jan 2018, 15:55:45
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
